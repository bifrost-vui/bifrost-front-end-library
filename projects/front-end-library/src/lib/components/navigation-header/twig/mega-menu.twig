{# Import macros #}
{% import "@bf-utils/macros/twig/index.twig" as macros %}

{# Template #}
<ul class="bf-megamenu">
  {% for mainMenuItem in mainMenuItems %}

    {# In Loop - Arrays of Classes With Dynamic Elements #}
    {% set navItemClasses = [
      "bf-megamenu__nav-item",
      "js-bf-megamenu__nav-item",
      mainMenuItem.class,
    ] %}
    {% set navItemLinkClasses = [
      "bf-megamenu__nav-item__link",
      mainMenuItem.class|default("")
    ] %}
    {% set navItemButtonClasses = [
      "bf-megamenu__nav-item__link",
      "js-bf-megamenu__nav-link"
    ] %}

    {# Main menu item #}
    <li class="{{ navItemClasses|join(' ')|trim }}">
      {% if not mainMenuItem.subItems and not mainMenuItem.subItemsMultiDropdown %}
        <a {{ macros.addAttributes({
          "class": navItemLinkClasses|join(' ')|trim ~ " bf-megamenu__nav-item__link--a",
          "href" : mainMenuItem.href|default("#"),
          "rel"  : mainMenuItem.rel|default("dofollow"),
          "style": (mainMenuItem.color ? "color: " ~ mainMenuItem.color ~ ";")
        }) }}>
          <span class="bf-megamenu__nav-item__link__text">
            {{ mainMenuItem.label }}
          </span>
        </a>
      {% else %}
        <button {{ macros.addAttributes({
          "class"        : navItemButtonClasses|join(' ')|trim ~ " bf-megamenu__nav-item__link--button",
          "type"         : "button",
          "id"           : "menuDropdown" ~ loop.index,
          "aria-expanded": "false",
          "aria-label"   : "Toggle navigation",
        }) }}>
          <span class="bf-megamenu__nav-item__link__text">
            {{ mainMenuItem.label }}
          </span>
          {% include "@bf-components/icon/twig/index.twig" with {
            class: "bf-megamenu__nav-item__link__icon d-none d-lg-block",
            name: "chevron-down",
            size: "xsmall"
          } %}
        </button>
      {% endif %}
    </li>
  {% endfor %}
</ul>
