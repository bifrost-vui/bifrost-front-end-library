import { moduleMetadata } from '@storybook/angular';
import { ArgsTable, Canvas, Meta, Story } from '@storybook/addon-docs';
import { withDesign } from 'storybook-addon-designs';
import interfaceIcons from '../../../../../../../public/icons/list/interfaces.json';
import { TwigContainerComponent } from '../../../../utils/twig-container/twig-container.component';
import { ButtonComponent } from '../angular/button.component';

<Meta
    title="Components/Button"
    component={ButtonComponent}
    decorators={[moduleMetadata({ declarations: [ButtonComponent, TwigContainerComponent] }), withDesign]}
    parameters={{
        design: {
            type: 'figma',
            url: 'https://www.figma.com/file/7bTmk29aCBl7rCFszffYPr/DS---Components-%26-styles?node-id=9579%3A88',
            disable: false,
        },
    }}
    argTypes={{
        hierarchy: {
            defaultValue: '',
            control: {
                type: 'select',
                options: ['', 'primary', 'primary-alt', 'secondary', 'tertiary'],
            },
        },
        formEncryptionType: {
            table: { defaultValue: { summary: `null` } },
            control: { type: 'select' },
        },
        formNoValidate: { table: { defaultValue: { summary: false } } },
        formTarget: {
            table: { defaultValue: { summary: `null` } },
            control: { type: 'select' },
        },
        iconName: {
            defaultValue: '',
            control: {
                type: 'select',
                options: [
                    '',
                    'placeholder',
                    ...interfaceIcons
                        .map((a) => a.list)
                        .flat()
                        .sort(),
                ],
            },
        },
        iconPosition: {
            defaultValue: '',
            table: { defaultValue: { summary: `left` } },
            control: {
                type: 'select',
                options: ['', 'left', 'right'],
            },
        },
        isDisabled: { table: { defaultValue: { summary: false } } },
        isLoading: { table: { defaultValue: { summary: false } } },
        isSubmit: { table: { defaultValue: { summary: false } } },
    }}
/>

# Button

Buttons allow users to take actions, and make choices, with a single tap. They are preferred for making an action, navigating between pages, open or close modal, submit a form, etc.

<br />

## Overview

A button is a simple component containing words, icon or both.

Consequently, a button is made of :

-   Hierarchy (Primary, Secondary, or Tertiary)
-   States (Default, Hover, Focus, Disabled, Loading)
-   Type of content (Label only, Icon left, Icon right, Icon only)
-   Variant or modifier (Alt, Reversed, CSR color)

## Usage

Use buttons to drive users on clear actions that help them achieve their goals.

An icon can be used next to the word, to emphasis on the purpose of the associated action. For instance, by using a right chevron when the button leads to another page (in a flow), or by using an icon when an external link is associated.

Buttons are generally displayed on :

-   Form pages
-   Modals
-   Action bars such as Sticky bottoms
-   Dialogs
-   Cards

## Hierarchy

Hierarchy purpose is to guide the user to a specific path by indicating different forces between actions. Buttons can be displayed in three different hierarchy types, indicating their strength.

-   Primary
-   Secondary
-   Tertiary

#### Primary

Primary buttons are used for calling the strongest action on the page.

A good practice is to use only one primary button in a page. It helps the user to know what they have being asked to do at this moment.

#### Primary Alternative

Primary-alt buttons are used the same way as Primary, but instead of having 1 main action on the page, the page provide multiple primary action.

#### Secondary

Secondary actions are less important than Primary, but its design suggests that they are still put forward. You can display several secondary buttons on a page.

#### Tertiary

Tertiary actions are the ones you want the less attention drawn on. Use them for "Cancel" or "Back" actions. You can display several tertiary buttons on a page.

## States

Each button has a visual feedback based on the user's action.

-   Hover (While hovering) : A subtle variation of color (background or stoke)
-   Focus (When selected by keyboard navigation) : A blue outline
-   Loading (When waiting) : A bubble animation
-   Disable (When not clickable) : Tone down using proper disable colors.

[Learn more about global states](https://www.figma.com/file/7bTmk29aCBl7rCFszffYPr/?node-id=30%3A0)

## Copywriting

The main rule to apply to buttons are to be **clear and concise**. Always try to match the writing to user's intents or gains.

The text will always be display in uppercase.

**Buttons should always:**

-   Start with a verb
-   Be unique, descriptive and informative (users need to know what is going to happen by clicking on a button)
-   Use task-specific language
-   Use precise diction
-   Use imperative form

**Common Buttons**
These types of buttons are usually explicit. Aim for conventional use.

Example:

-   Save & Exit
-   Next / Back

**High-value buttons**

Use these during key moments in the experience on specific occasions.

Example:

-   A button on the last page of a conversion funnel
-   The button on a page describing a new product which can be pre-ordered by an user

Rules to apply: **Value + relevance**

Value: As a user what will I gain following through this ?
Relevance: Is the context specific enough for me to follow through ?

## Good practices

#### ✅ **Do**

> -   Write label on a single line for maximum legibility.
> -   One Primary per page or Primary Alt if more

#### ⛔ **Don’t**

> -   Don't write long text that is displayed on multiple lines. The legibility would be affected and the recognition of the component as a button would be more difficult.
> -   Don't' use multiple principals button on the same page.

## Design Guidelines

Check the [Figma](https://www.figma.com/embed?embed_host=share&url=https%3A%2F%2Fwww.figma.com%2Ffile%2F7bTmk29aCBl7rCFszffYPr%2FDS---Components-%2526-styles%3Fnode-id%3D9579%253A88) for more details

<iframe
    width="100%"
    height="450"
    src="https://www.figma.com/embed?embed_host=share&url=https%3A%2F%2Fwww.figma.com%2Ffile%2F7bTmk29aCBl7rCFszffYPr%2FDS---Components-%2526-styles%3Fnode-id%3D9579%253A88"
    frameBorder="0"
    allowFullScreen
></iframe>

## Component API

<ArgsTable of={ButtonComponent} />

## Drupal implementation example

```jsx
// Button
{% include '@bf-components/button/twig/index.twig' with {
    label           : 'Button label',
    hierarchy       : 'primary',
    isDisabled      : false,
    isLoading       : false,
    iconName        : 'placeholder',
    iconPosition    : 'right',
    class           : 'mt-3',
} only %}

// Link
{% include '@bf-components/button/twig/index.twig' with {
    label           : 'Button label',
    hierarchy       : 'primary',
    href            : 'https://example.com',
    isDisabled      : false,
    isLoading       : false,
    iconName        : 'placeholder',
    iconPosition    : 'right',
    class           : 'mt-3',
} only %}

// Submit button
{% include '@bf-components/button/twig/index.twig' with {
    label           : 'Button label',
    hierarchy       : 'primary',
    isSubmit        : true,
    class           : 'mt-3',
} only %}

//  Loading button
{% include '@bf-components/button/twig/index.twig' with {
    label           : 'Button label',
    hierarchy       : 'primary',
    isLoading       : true,
    iconName        : 'placeholder',
    iconPosition    : 'right',
    class           : 'mt-3',
} only %}
```

## Drupal

export const Drupal = (args) => ({
    component: TwigContainerComponent,
    props: args,
});

<Canvas withSource="none">
    <Story
        name="Drupal"
        args={{
            elementPath: 'components/button/_doc/template.drupal',
            class: 'mb-3',
            dataDismiss: 'dataDismiss',
            dataToggle: 'dataToggle',
            dataTarget: 'dataTarget',
            ariaControls: 'ariaControls',
            ariaExpanded: 'ariaExpanded',
            ariaLabel: 'ariaLabel',
            isDisabled: undefined,
            isLoading: undefined,
        }}
    >
        {Drupal.bind({})}
    </Story>
</Canvas>

<Canvas withSource="none">
    <Story
        name="Drupal - CSS only"
        height="700px"
        parameters={{ options: { showPanel: false } }}
        args={{
            elementPath: 'components/button/_doc/css-only.drupal',
            class: 'ml-4 mb-3',
        }}
    >
        {Drupal.bind({})}
    </Story>
</Canvas>
